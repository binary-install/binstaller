# Reproducible Builds

Goinstaller supports reproducible builds, which means that the same input will always produce the same output. This is important for security and auditing purposes, as it allows users to verify that the script they are using was generated from a specific source.

## Source Information

By default, goinstaller includes source information in the generated script. This information includes:

- For GitHub repositories: `owner/repo@commit_hash`
- For local files in git repositories: `owner/repo@commit_hash`
- For files with uncommitted changes: `owner/repo:path/to/file.yml(uncommitted sha256:hash)`
- For files not in git repositories: `path/to/file@sha256:hash`

This source information is included in the header of the generated script, making it easy to trace the script back to its source.

## Specifying a Commit Hash

You can specify a commit hash when generating a script from a GitHub repository. This allows you to generate a script from a specific version of the repository, which is useful for reproducibility and auditing.

```bash
goinstaller --repo=owner/repo --commit=abc123
```

This will generate a script using the specified commit hash, rather than the latest commit on the default branch.

## Minimizing Changes

When updating installation scripts, you may want to minimize the changes between versions. By default, the source information and version are included in the generated script, which can cause unnecessary changes when the source changes but the script content remains the same.

To minimize changes, you can use the `--skip-source-info` flag to exclude the source information and version from the generated script:

```bash
goinstaller --repo=owner/repo --skip-source-info
```

This is particularly useful when the script content doesn't change between versions, such as when the only changes are to the attestation verification. The generated script will have a simplified header:

```bash
#!/bin/sh
set -e
# Code generated by goinstaller. DO NOT EDIT.
#
```

Instead of the default header that includes version and source information:

```bash
#!/bin/sh
set -e
# Code generated by goinstaller (dev) from owner/repo@abc123. DO NOT EDIT.
#
```

## Best Practices

For maximum reproducibility and security, we recommend:

1. Always specify a commit hash when generating scripts for production use
2. Include source information in the script for traceability
3. Use attestation verification to ensure the integrity of the downloaded binaries
4. Keep a record of the exact command used to generate the script

For development and testing, you may want to use the `--skip-source-info` flag to minimize changes between versions.
